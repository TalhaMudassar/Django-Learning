

{% extends "student/base.html" %}

{% block left-content %}
<form action="" method="POST" enctype="multipart/form-data">
  {% csrf_token %}

  <!-- Non field errors -->
  {% if form.non_field_errors %}
    {% for error in form.non_field_errors %}
      <p class="alert alert-danger my-3">{{ error }}</p>
    {% endfor %}
  {% endif %}

  <!-- Loop through all fields except profile_image and my_file -->
  {% for field in form %}
    {% if field.name != "profile_image" and field.name != "my_file" %}
      <div class="mb-3">
        <label for="{{ field.id_for_label }}" class="form-label">{{ field.label }}</label>
        {{ field }}
        {% if field.help_text %}
          <div class="form-text">{{ field.help_text }}</div>
        {% endif %}
        {% for error in field.errors %}
          <p class="text-danger">{{ error }}</p>
        {% endfor %}
      </div>
    {% endif %}
  {% endfor %}

  <!-- Profile Image -->
  <div class="mb-3">
    <label for="{{ form.profile_image.id_for_label }}" class="form-label">{{ form.profile_image.label }}</label>
    {{ form.profile_image }}
    {% if form.profile_image.help_text %}
      <div class="form-text">{{ form.profile_image.help_text }}</div>
    {% endif %}
    <div class="mt-3">
      <img id="imagePreview" src="" alt="Image Preview" style="display:none; max-width:50%; height:auto;">
    </div>
    {% for error in form.profile_image.errors %}
      <p class="text-danger">{{ error }}</p>
    {% endfor %}
  </div>

  <!-- My File -->
  <div class="mb-3">
    <label for="{{ form.my_file.id_for_label }}" class="form-label">{{ form.my_file.label }}</label>
    {{ form.my_file }}
    {% if form.my_file.help_text %}
      <div class="form-text">{{ form.my_file.help_text }}</div>
    {% endif %}
    {% for error in form.my_file.errors %}
      <p class="text-danger">{{ error }}</p>
    {% endfor %}
  </div>

  <!-- Submit button -->
  <button type="submit" class="btn btn-primary">Submit</button>
</form>

<!-- Script for image preview -->
<script>
  function previewImage(event) {
    const imagePreview = document.getElementById('imagePreview');
    const file = event.target.files[0];
    if (file) {
      const reader = new FileReader();
      reader.onload = function(e) {
        imagePreview.src = e.target.result;
        imagePreview.style.display = 'block';
      };
      reader.readAsDataURL(file);
    } else {
      imagePreview.style.display = 'none';
    }
  }

  const profileInput = document.getElementById("{{ form.profile_image.id_for_label }}");
  if (profileInput) {
    profileInput.addEventListener("change", previewImage);
  }
</script>
{% endblock left-content %}

{% block right-content %}
<h4 class="text-center mb-3"><u>List of Candidate</u></h4>
{% for candidate in candidates %}
  <p>{{ candidate.id }} : <a href="{% url 'candidate_detail' candidate.id %}">{{ candidate.name }}</a></p>
{% empty %}
  <p class="text-muted">No candidates available.</p>
{% endfor %}
{% endblock right-content %}
